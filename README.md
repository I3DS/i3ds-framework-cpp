# I3DS C++ framework

This is the I3DS sensor suite C++ framework for creating sensor
interfaces with the ASN.1 message formats and the ZMQ communication
library. The framework also contains sensor emulators, and services
and tools for interfacing with the sensor suite. Bindings to the
Python programming language for the sensor clients are also provided.

## libi3ds

This is the library containing the functionality of the I3DS C++
framework, including the ASN.1 encoders and decoders that are
generated using ASN1CC. It is organized in a standard way with headers
under `include/i3ds`, source code under `src` and unit tests under
`tests` using the Boost unit test framework.

The details of ZMQ are hidden in `communication.hpp`. This package
also specifies the address consisting of a node and endpoint ID.
Addresses are used for identifying messages so that they can reach the
correct receiver. Generic communication patterns such as publish /
subscribe and request / response are found in files `publisher.hpp`,
`subscriber.hpp`, `client.hpp` and `server.hpp` respectively.  The
encoding and decoding of messages with the ASN.1 uPER message format
is handled by `codec.hpp` that defines thin C++ wrappers around the C
code generated by the ASN.1 compiler. For simplicity the endpoint ID
and message format are bound together in C++ structs as either a
service with input/output data in `service.hpp` or as a publish /
subscribe topic in `topic.hpp`.

Basic sensor functionality with the state machine is defined in
`sensor.hpp`. More specific sensor interfaces such as a camera in
`camera.hpp` inherit from this class, and the concrete device
interfaces inherit from these again and override the service methods
they support. Emulated sensor are defined for all main classes. These
allow for testing of commands and queries, but do not produce
meaningful sensor data as of now.

## Services

The following services are provided:

* The I3DS address server that is used by the communication parts of
  the library to translate a node ID and pattern to a ZMQ address with
  IP and port. The service reads in a simple CSV file in memory at
  startup. The format of the file is `323,pub,b,tcp://127.0.0.1:7000`,
  where the first integer is the node ID, then the ZMQ pattern (pub,
  sub, req, rep), then whether to bind (b) or connect (c), and then
  finally the ZMQ address specifying protocol, IP and port.

* The sensor suite emulator that creates one of each of the supported
  sensors of the I3DS sensor suites from the provided base address.

Use the `--help` argument to get the detailed usage.

## Tools 

The following tools are provided:

* Configuration tools for the different sensor interfaces.
* A camera capture tool for capturing image frames.

Use the `--help` argument to get the detailed usage.

## Building and installing

The framework has the following build dependencies:

* cmake
* C++11 compiler (only tested with GCC)
* ZMQ libraries
* Boost framework (program options and unit test)
* SWIG and Python development files for optional Python binding

To build and install the framework with CMake do the following:

```
mkdir build/
cd build/
cmake .. -DASN1CC_SRC_ROOT_FOLDER=[Path to asn1scc build]
make
make test
sudo make install
sudo ldconfig
```

This will install the headers under `/usr/local/include/i3ds`,
`libi3ds.so` under `/usr/local/lib`, and the tools and services under
`/usr/local/bin`. The Python bindings are put in the local install
directory that can vary among distributions.
